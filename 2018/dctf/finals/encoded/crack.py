p1 = 22038577616157637425143990739044468042942035165297967981830333958085447313379989590261519506703428955869923361060427418930198935893812780279066891874345673666735637948823258444959615804901469544334428552362386448790252323968738406231180181104084006062126979350528
p2 = 122261123028562171317704981271633892512307776190446649089093904995028071517553009633384643052223671845896763911299558158308657503800840355637321140578345396731904
p3 = 190924035134471114677647166330091216967369394747138120074783434804961234911473065041948752259153571413726332406654571871295046489123594696063385410815743836252707943837573081504845660160

password = '60803083391664635787568612973650396517786362444125926964378255248069659336573803644359570871688565027791218340291075024736035241943322302689869894558514004927000287717116888550739154025644676856597182626292581474583725032617269560007192402131419136'

# p = 'DCTFflag'
# p_enc = p[::-1].encode('hex')
# e = int(p_enc[:3], 16)
# m = int("1" + p_enc[3:], 16)
# print 2 ** (e - 1023 - 52) * m


p_start = ('0'*8).encode('hex')
p_end = ('z'*8).encode('hex')
e_start = int(p_start[:3], 16)
e_start = 1023 + 53
e_end = int(p_end[:3], 16)
m_start = int("1" + p_start[3:], 16)
m_end = int("1" + p_end[3:], 16)

print e_start, e_end
print m_start, m_end

for e in xrange(e_start, e_end+1):
    d = 2 ** (e - 1023 - 52)

    i = 50;
    while i <= len(password):
        p = password[:i]

        r = divmod(int(p), d)
        if r[1] == 0 and r[0] >= m_start and r[0] <= m_end:
            # print 'Found exp', e
            print p
        i = i + 1
