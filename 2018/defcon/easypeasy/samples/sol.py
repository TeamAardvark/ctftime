import hashlib
from Crypto.Util.number import bytes_to_long, long_to_bytes

ciao = '27480844e7f075a3bde72316bb6acbf1957ab6479f9facdefda9a2553f1abf526a96ace948ed61389797f0e7622d749af9069f22b8143cf8f18591899eeab74e807e33263969dc31de2c0a93cf01d3c30440bafd52a349474b775f670a01b3d6c5986d2f127323d8f7045d2cbab5e3549f945460bc7707febea53846c3ce0f3374b365823da25c4e885ddc4f77eaa876649dca168138e50458855eaafbd0c5c63b18d0c596f4a671fc4826ea0494558d57d0b9fbebef5058d66d18ca90a7e44beb33249acc3a36929a2ef11c034da89c99c5dd36c1f582f30199e15fc88cd98dd2b9d87c9796f0a24ef17269b8ad448a602ab0c568af11559134dd513b92a4c5'

product = '4aba5e2166bdbeb26d0946d050ab041116d0342bf5817329250b0f8a6122213a3117c0bb1bc7b4c47ab449dedc2379ce7fb50a6571639a382701ef2481e720ce80e31ab299665adf43934f6718109a92a655ac165a929a663786a83f1a704b4f4572cc3af3a531c6d73ab435e1b326fb92ab254b187a2e01b1726c6174524be3f733055310c77238ba45509e8a85ec9a07e7c2330e0a235f74cd941cc8a6ac5107c986f8e384f1edc28fcd164e0a9ec26f525437cbaa2857705b30ae1ffa1b40fd9bb2da203ea9233c6953bb7e59bd16e5ac36066733b8b049f3e91a9f459a05b1f885458c0835626c84eca1d84af1ffc69af8c934d507a2f7fd22f98fa8e05b'

openedFile = open('echo-ciao.ppm')
readFile = openedFile.read()
fileLen = len(readFile)
fullLen = ((fileLen / 64) + 1) * 64
bytesLen = long_to_bytes(fileLen)
readFile += '\x80' + '\x00'*(fullLen - fileLen - 1 - len(bytesLen)) + bytesLen

print len(readFile) / 64. , bytesLen.encode('hex')

sha1Hash = hashlib.sha1()
sha1Hash.update(readFile)
print sha1Hash.hexdigest()



# c918586a2520a3bcaccf243d98f7bfe5bae9b25b15705b1f3d9f2641afe1081c2bd01c44d2e759614b82ec4428f565ae0de148766bdc803378fb210ad8bb014484d7373e8390836a2c9bc8d64f8ed2469f88fd7ccd00bcf8afcf9736364348d8dbb91ce9bf4794ca6a0452316f0648f49c9b32e1b1aee269274e566ecae01bee175e3432f2b79f9b87fe8e33aef79eba34dd6892b4ae515d88029cca0955e9f3610a21e6c8d97dc269de02718b501cd254b5ec52dc1e31543414c4a7acd5cdbaa557df1e930f5fd434d1dbbc1f5610bec5060a0a633cd7ce0ae18613cc9e7d123e601c40e67a56c9b70853e24dcb751967b1685265ed584c9a72ea9aabb48a97